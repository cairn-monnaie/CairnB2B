{# src/Cairn/UserBundle/Resources/views/Mandate/_form.html.twig #}         
                                                                               
{% extends "CairnUserBundle::layout.html.twig" %}                        
                                                                               
{% trans_default_domain 'FOSUserBundle' %}

{% block body %}

<div class="row">
        {{ form_start(form) }}
        <div class="row js-document-wrapper"
            data-prototype="{{ form_widget(form.mandateDocuments.vars.prototype)|e('html_attr') }}"
            data-index="{{ form.mandateDocuments|length }}"
        >
            {% for documentField in form.mandateDocuments %}
             <div class="col s12 m6 js-document-item">
                <div class="row ">
                    <div class="col s12">
                        {{ form_errors(documentField) }}
                        {{ form_label(documentField) }}
                    </div>
                    <div class="col s12">
                        {{ form_widget(documentField) }}
                    </div>
                </div>
             </div>
            {% endfor %}
        </div>
         <div class="col s12">
            <a href="#" class="js-document-add">
                <i class="material-icons">add</i>
            </a>
         </div>

    {{ form_rest(form) }}
    {{ form_end(form) }}
</div>

{% endblock %}

{% block javascripts %}

<script>

    jQuery(document).ready(function() {
        var $wrapper = $('.js-document-wrapper');

        var $addLink = $('.js-document-add').parent();

        $addLink.on('click', function(e) {
            e.preventDefault();

            var prototype = $wrapper.data('prototype');
            var index = $wrapper.data('index');

            var newFormField = prototype.replace(/__name__label__/g, 'Document nÂ°' + (index+1)).replace(/__name__/g, index);

            $wrapper.data('index', index + 1);
            $(this).before(newFormField);


            $(this).hide();
        });
      });
    
</script>

{% endblock %}
