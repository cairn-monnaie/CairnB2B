{# src/Cairn/UserBundle/Resources/views/Banking/view_single_transactions.html.twig #}

{% extends "CairnUserBundle::layout.html.twig" %}

{% block body %}
    {{parent()}}

    {% if futureInstallments | length %}
    <table>
    <caption> <span> Vos virements simples à venir </span> </caption>
    <thead>
        <tr>
            <th> Date de demande </th>
            <th> Date d'éxecution </th>
            <th> Bénéficiaire</th>
            <th> Motif </th> 
            <th> Montant </th>
            <th> Etat </th>
            <th> Action </th>
 
        </tr>
    </thead>

    <tbody>
    {% for installment in futureInstallments %}
                <tr>
                    <td> {{installment.submissionDate|date('Y-m-d')}} </td>
                    <td> {{installment.executionDate|date('Y-m-d')}} </td>
                    <td>
                        {#{% if installment.creditor is defined %}#}
                            <a href="{{path('cairn_user_profile_view', {'id' : installment.creditor.id})}}"> {{installment.creditorName}} </a>
                        {#{% else %}#}
                            {#{{installment.creditorName}}#}
                        {#{% endif %}#}
                    </td>
                    <td> {{installment.reason }} </td>  
                    <td> {{installment.amount }} </td>
                    {% if installment.type == constant('Cairn\\UserBundle\\Entity\\Operation::TYPE_TRANSACTION_SCHEDULED') %}
                        <td> En cours </td>
                    {% elseif installment.type == constant('Cairn\\UserBundle\\Entity\\Operation::TYPE_SCHEDULED_FAILED') %}
                        <td> Echoué </td>
                    {% endif %}
                    <td>
                         <a href="{{path('cairn_user_banking_transaction_scheduled_changestatus', {'id' : installment.paymentID,'status' : 'cancel' })}}"> Annuler </a>
                     | 
                         <a href="{{path('cairn_user_banking_transaction_scheduled_changestatus', {'id' : installment.paymentID,'status' : 'execute' })}}"> Exécuter maintenant </a>
                    </td>
                </tr>
    {% else %}
        <tr>
            <td colspan="7" class="center-align">Aucun virement en attente</td>
        </tr>
    {% endfor %}
    </tbody>
    </table>

{% endif %}

    <h2>Vos virements passés</h2>
    <table>
    <thead>
        <tr>
            <th> Date d'éxecution </th>
            <th> Bénéficiaire</th>
            <th> Motif </th> 
            <th> Montant </th>
            <th> Action </th>

        </tr>
    </thead>

    <tbody>
    {% for transaction in processedTransactions %}
                <tr>
                    <td> {{transaction.executionDate|date('Y-m-d')}} </td>
                    <td>
                        {#{% if transaction.creditor is defined %}#}
                            {#<a href="{{path('cairn_user_profile_view', {'id' : transaction.creditor.id})}}"> {{transaction.creditorName}} </a>#}
                        {#{% else %}#}
                            {{transaction.creditorName}}
                        {#{% endif %}#}
                    </td>
                    <td> {{transaction.reason }} </td>  
                    <td> {{transaction.amount }} </td>
                    <td> <a href="{{path('cairn_user_banking_transfer_view', {'type':'simple','id' : transaction.id})}}"> Voir le détail </a></td>
                </tr>
    {% else %}
        <tr>
            <td colspan="5" class="center-align">Aucun virement en attente</td>
        </tr>
    {% endfor %}
    </tbody>
    </table>

</div>
{% endblock %}

